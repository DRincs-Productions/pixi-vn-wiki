---
title: Integrazione del linguaggio ink
description: Scrivere narrazioni interattive utilizzando ink, un linguaggio di scripting progettato per storie ramificate, integrato con Pixi'VN.
---

import { InkExample } from "@/components/ink-examples";

Pixi’VN ti consente di scrivere narrazioni interattive utilizzando **_ink_**, un linguaggio di scripting progettato per storie ramificate.

**Cos'è _ink_?** **_ink_** è un semplice linguaggio di scripting per storie interattive, utilizzato in giochi come 80 Days, Heaven's Vault e Sorcery! Per saperne di più, visita il [sito web di _ink_](https://www.inklestudios.com/ink/).

L'integrazione **_ink_ + Pixi’VN** utilizza [inkjs](https://github.com/inkle/inkjs) e <DynamicLink href="/json">PixiVNJson</DynamicLink> per analizzare il codice **_ink_** e generare JSON che Pixi’VN può interpretare. Ciò significa che JavaScript/TypeScript e **_ink_** condividono lo stesso spazio di archiviazione e la stessa area di lavoro, e puoi avviare `knots` (o `labels`) di **_ink_** da JavaScript/TypeScript e viceversa. Ottieni il meglio da entrambi i mondi: scrivi la narrazione in **_ink_** e usa JavaScript/TypeScript per i minigiochi o le animazioni avanzate.

```ink title="ink/start.ink"
=== start ===
We arrived into London at 9.45pm exactly.

* "There is not a moment to lose!"[] I declared.
 -> hurry_outside

* "Monsieur, let us savour this moment!"[] I declared.
 My master clouted me firmly around the head and dragged me out of the door.
 -> dragged_outside

* [We hurried home] -> hurry_outside

=== hurry_outside ===
We hurried home to Savile Row -> as_fast_as_we_could

=== dragged_outside ===
He insisted that we hurried home to Savile Row
-> as_fast_as_we_could

=== as_fast_as_we_could ===
<> as fast as we could.
-> start
```

<InkExample />

## Perché?

Scrivere una narrazione direttamente in **JavaScript/TypeScript** può essere lento e complesso, soprattutto per i principianti. **_ink_** è molto più facile da imparare e scrivere.

I nuovi sviluppatori possono iniziare con un modello <DynamicLink href="/start#project-initialization">_ink_</DynamicLink>, per poi imparare gradualmente JavaScript/TypeScript per ottenere funzionalità avanzate.

## Installazione

<Callout title="Templates" type="info">

Stai iniziando un nuovo progetto Pixi'VN? Utilizza un <DynamicLink href="/start#project-initialization">template</DynamicLink> che includa già _ink_.

</Callout>

Per installare il pacchetto _ink_ in un progetto JavaScript esistente, utilizzare uno dei seguenti comandi:

```sh tab="npm"
npm install @drincs/pixi-vn @drincs/pixi-vn-ink
```

```sh tab="yarn"
yarn add @drincs/pixi-vn @drincs/pixi-vn-ink
```

```sh tab="pnpm"
pnpm add @drincs/pixi-vn @drincs/pixi-vn-ink
```

```sh tab="bun"
bun add @drincs/pixi-vn @drincs/pixi-vn-ink
```

```sh tab="deno"
deno install npm:@drincs/pixi-vn npm:@drincs/pixi-vn-ink
```

### Inizializzare

Dopo l'installazione, usa `importInkText()` per caricare il tuo script **_ink_**:

```typescript title="main.ts"
import { importInkText } from '@drincs/pixi-vn-ink'

const inkText = `
=== start ===
Hello
-> END
`

importInkText([inkText, ...])
```

Ora puoi eseguire un **_ink_ `knot`** (o `label`) utilizzando le <DynamicLink href="/start/labels#run-a-label">funzioni Pixi’VN</DynamicLink>:

```typescript title="main.ts"
import { narration } from '@drincs/pixi-vn'

narration.call(`start`, {})
```

<Accordions>

<Accordion title="import_ink_files" id="import-ink-files">

<Callout type="info">

Questa guida utilizza [Vite](https://vitejs.dev/), ma la stessa logica si applica anche altrove.

</Callout>

Per importare i file `.ink`, è necessario configurare il progetto in modo che li gestisca come file di testo.

Di seguito sono riportati i passaggi per farlo:

- Dichiarare il modulo `*.ink` in `ink.d.ts`.
- Aggiungere `.ink` a `assetsInclude` in `vite.config.ts`.
- Importare il file con `?raw` per ottenerne il contenuto testuale.

```ts tab="main.ts"
import { importInkText } from '@drincs/pixi-vn-ink'
import startLabel from './ink/start.ink?raw'

importInkText([startLabel, ...])
```

```ts tab="vite.config.ts"
export default defineConfig({
  // ...
  assetsInclude: ['**/*.ink'],
})
```

```ts tab="ink.d.ts"
declare module '*.ink' {
    const value: string
    export default value
}
```

</Accordion>

<Accordion title="import_ink_folder" id="import-ink-folder">

<Callout type="info">

Questa guida utilizza [Vite](https://vitejs.dev/), ma la stessa logica si applica anche altrove.

</Callout>

Per importare più file `.ink`, utilizzare `import.meta.glob`:

```ts tab="utils/ink-utility.ts"
import { convertInkText, importInkText } from "@drincs/pixi-vn-ink";

async function getInkText() {
    const files = import.meta.glob<string>("../ink/*.ink", { query: "?raw", import: "default" });
    return await Promise.all(
        Object.values(files).map(async (importFile) => {
            return await importFile();
        })
    );
}

export async function importAllInkLabels() {
    let fileEntries = await getInkText();
    await importInkText(fileEntries);
}

export async function convertInkToJson() {
    let fileEntries = await getInkText();
    return await Promise.all(fileEntries.map((data) => convertInkText(data)));
}
```

```ts tab="vite.config.ts"
export default defineConfig({
  // ...
  assetsInclude: ['**/*.ink'],
})
```

</Accordion>

<Accordion title="vite_js_plugin" id="vite-plugin">

Per una migliore esperienza di sviluppo, utilizza il plugin Vite:

```ts tab="vite.config.ts"
import { defineConfig } from 'vite'
import { vitePluginInk } from '@drincs/pixi-vn-ink/vite'
export default defineConfig({
  // ...
  plugins: [
    // other plugins...
    vitePluginInk()
  ]
})
```

```ts tab="main.ts"
import { setupInkHmrListener } from '@drincs/pixi-vn-ink/vite-listener'

setupInkHmrListener()
```

```ts tab="utils/ink-utility.ts"
async function getInkText() {
    const files = import.meta.glob<string>("../ink/*.ink", { eager: true, import: "default" });
    return await Promise.all(
        Object.values(files).map(async (importFile) => {
            return importFile;
        })
    );
}
```

</Accordion>

</Accordions>

## Prossime funzionalità

Queste funzionalità sono in fase di sviluppo.

<Callout type="info">

Mostra il tuo interesse mettendo "Mi piace" o commentando gli argomenti.

</Callout>

- [Functions and Game Queries](https://github.com/inkle/ink/blob/master/Documentation/WritingWithInk.md#9-game-queries-and-functions) ([#11](https://github.com/DRincs-Productions/pixi-vn-ink/issues/11)):
  - [User-created functions](https://github.com/inkle/ink/blob/master/Documentation/WritingWithInk.md#5-functions) ([#32](https://github.com/DRincs-Productions/pixi-vn-ink/issues/32))
  - `CHOICE_COUNT()`
  - `TURNS()`
  - `TURNS_SINCE()`
  - `SEED_RANDOM()`
- [`LIST`](https://github.com/inkle/ink/blob/master/Documentation/WritingWithInk.md#1-basic-lists) ([#15](https://github.com/DRincs-Productions/pixi-vn-ink/issues/15))
- [`Tunnels`](https://github.com/inkle/ink/blob/master/Documentation/WritingWithInk.md#1-tunnels) ([#38](https://github.com/DRincs-Productions/pixi-vn-ink/issues/38))

## Sintassi ignorata da Pixi'VN

Pixi'VN ignora parte della sintassi _ink_. Puoi usarli nel tuo **script _ink_** (ad esempio, per testare nell'editor Inky), ma Pixi'VN li ignorerà.

### INCLUDE

`INCLUDE` è un'istruzione _ink_ per includere un altro file _ink_. In Pixi'VN, dovresti usare `importInkText()` per caricare più file _ink_, quindi `INCLUDE` viene ignorato.

### Narrazione fuori dai `knots`

La narrazione al di fuori dei `knots` (o `labels`) viene ignorata, fatta eccezione per le variabili.

Ad esempio:

```ink title="ink"
VAR my_var = false // ✅ This will be handled (because it is a variable)
Hello // ❌ This will be ignored  [!code warning]
-> start // ❌ This will be ignored [!code warning]
=== start === // ✅ This will be handled
My name is John // ✅ This will be handled
-> DONE // ✅ This will be handled
```

<Accordions>

<Accordion title="ink_differences" id="ink-differences">

- in questo caso:

  ```ink title="ink"
  { shuffle:
    -  2 of Diamonds.
      'You lose this time!' crowed the croupier.
  }
  ```

    **Nella versione nativa di _ink_**, vedrai due dialoghi diversi, il primo sarà `2 of Diamonds.` e il secondo sarà `'You lose this time!' crowed the croupier.`.

    **In Pixi’VN _ink_**, non vedrai due dialoghi diversi, ma il seguente dialogo: `2 of Diamonds.\n\n'You lose this time!' crowed the croupier.`. In <DynamicLink href="/ink/markup#markdown-on-ink">Markdown</DynamicLink> verrà visualizzato in questo modo:

  ```txt
  2 of Diamonds.
  'You lose this time!' crowed the croupier.
  ```

- se un `weave` (nell'esempio seguente `shove`) è associato a una scelta una tantum e viene aperto con `-> shove`, ciò non invaliderà la scelta una tantum. Per invalidarlo dovrai selezionare la scelta come di consueto.

    Ecco un esempio:

  ```ink title="ink"
  -> start
  === start ===
  * [1] -> shove
  * (shove) [2] 2
  * {shove} [3] -> END
  -  -> start
  -> DONE
  ```

    Nel caso in cui si scelga `1`, la seconda volta verrà aperto `start`:

  - se utilizzi **_ink_ nativo**, potrai scegliere solo l'opzione `3`. La scelta `2` è nascosta perché essendo un **ink** nativo\* "una tantum" saprà che hai già preso questa decisione con `-> shove`.
  - se utilizzi **Pixi’VN _ink_**, potrai scegliere l'opzione `2` o `3`. La scelta `2` non è nascosta perché **Pixi’VN _ink_** non sa che `shove` è associato a una scelta.

  Per ottenere la stessa logica di `start` sia in **native _ink_** che in **Pixi’VN _ink_** dovrai scrivere il seguente codice:

  ```ink title="ink"
  -> start
  === start ===
  * [1] -> shove
  * (shove) {!shove} [2] 2
  * {shove} [3] -> END
  -  -> start
  -> DONE
  ```

</Accordion>

</Accordions>
