---
title: Characters
---
import { CharacterDialogueExample } from "@/components/ink-examples";
import { Accordion, Accordions } from 'fumadocs-ui/components/accordion';

Before to read this section, it is recommended to read <DynamicLink href="/start/character#initialize">How to create and use characters in Pixi’VN</DynamicLink>.

## Use

### Associate a character with a dialogue

You can associate a character with a dialogue in ***ink***. To do this, you need to use the following syntax:

`[character_id]` + `:` + `SPACE` + `[text]`

* `character_id`: is the character `id` defined in **JavaScript/TypeScript**.
* `:`: is the separator between the character and the text.
* `SPACE`: is very important, you need to add a space after the `:`.
* `text`: is the dialogue text.

```ink tab="ink/start.ink"
=== start ===
egg-head: Hello, I'm Egg.
-> DONE
```

```ts tab="values/characters.ts"
import { CharacterBaseModel, RegisteredCharacters } from "@drincs/pixi-vn";

export const eggHead = new CharacterBaseModel("egg-head", {
  name: "Egg",
  surname: "Head",
  age: 25,
  icon: "https://pixijs.com/assets/eggHead.png",
  color: "#9e2e12",
});

RegisteredCharacters.add(eggHead);
```

```ts tab="src/main.ts"
import "./values/characters";

// ...
```

<CharacterDialogueExample />

### Use character name in dialogues text

You can use the character name in dialogues. To do this, you need to use the following syntax:

`[` + `character_id` + `]`

* `[` and `]`: are the delimiters to identify the character.
* `character_id`: is the character `id` defined in **JavaScript/TypeScript**.

```ink tab="ink/start.ink"
=== start ===
Hello, [egg-head].
-> DONE
```

```ts tab="values/characters.ts"
import { CharacterBaseModel, RegisteredCharacters } from "@drincs/pixi-vn";

export const eggHead = new CharacterBaseModel("egg-head", {
  name: "Egg",
  surname: "Head",
  age: 25,
  icon: "https://pixijs.com/assets/eggHead.png",
  color: "#9e2e12",
});

RegisteredCharacters.add(eggHead);
```

To do this, you'll first need to implement the functionality to replace the id with the character's name. To do this, you can use one of the following methods:

<Callout title="Templates" type="info">

In all templates, this implementation is already included.

</Callout>

</Accordion>

<Accordion title="i18next implementation" id="i18next-implementation">

If you are using [i18next](https://www.i18next.com/) for translation, you can use the following method:

```ts tab="utils/ink-utility.ts"
import { onReplaceTextBeforeTranslation } from "@drincs/pixi-vn-ink";

export function initializeInk() {
    onReplaceTextBeforeTranslation((key) => { // [!code focus]
        return `{{${key}}}`; // [!code focus]
    }); // [!code focus]
}
```

```ts tab="i18n.ts"
import { RegisteredCharacters } from "@drincs/pixi-vn";
import i18n from "i18next";
import Backend from "i18next-chained-backend";
import { initReactI18next } from "react-i18next";

export const useI18n = () => {
    if (!i18n.isInitialized) {
        i18n.use(Backend)
            .use(initReactI18next)
            .init({
                debug: false,
                fallbackLng: "en",
                lng: "en",
                interpolation: {
                    escapeValue: false,
                },
                load: "currentOnly",
                missingInterpolationHandler(_text, value, _options) { // [!code focus]
                    let key = value[1]; // [!code focus]
                    let character = RegisteredCharacters.get(key); // [!code focus]
                    if (character) { // [!code focus]
                        return character.name; // [!code focus]
                    } // [!code focus]
                    return `[${key}]`; // [!code focus]
                }, // [!code focus]
            });
    }
};
```

</Accordion>

<Accordion title="Replacement implementation" id="replacement-implementation">

To use the character name in dialogues, you can take advantage of the <DynamicLink href="/ink/replacement">possibility of replacing portions of text</DynamicLink>. For example, you can use the following method:

```ts name="utils/ink-utility.ts"
import { RegisteredCharacters } from "@drincs/pixi-vn";
import { onReplaceTextAfterTranslation } from "@drincs/pixi-vn-ink";

export function initializeInk() {
    onReplaceTextAfterTranslation((key) => { // [!code focus]
        let character = RegisteredCharacters.get(key); // [!code focus]
        if (character) { // [!code focus]
            return character.name; // [!code focus]
        } // [!code focus]
 // [!code focus]
        // if return undefined, the system will not replace the character id // [!code focus]
        return undefined; // [!code focus]
    }); // [!code focus]
}
```

</Accordion>

</Accordions>

## Edit

To edit the character name in dialogues, you can take advantage of the possibility of <DynamicLink href="/ink/hashtag">customizing hashtag scripts</DynamicLink>. For example, you can use the following method:

```ts tab="main.ts"
import { onInkHashtagScript } from '@drincs/pixi-vn-ink'

onInkHashtagScript((script, convertListStringToObj) => {
    if (script[0] === "rename" && script.length === 3) {
        let character = getCharacterById(script[1])
        if (character) {
            character.name = script[2]
        }
        return true
    }
    return false
})
```

```ink tab="ink/start.ink"
=== start ===
# rename liam_id Liam
-> DONE
```

```ts tab="values/characters.ts"
import { CharacterBaseModel, RegisteredCharacters } from "@drincs/pixi-vn";

export const liam = new CharacterBaseModel('liam_id', {
    name: 'Liam',
    surname: 'Smith',
    age: 25,
    icon: "https://example.com/liam.png",
    color: "#9e2e12"
});

RegisteredCharacters.add([liam]);
```

## Character emotions

You can use the <DynamicLink href="/start/character#character-emotions">Pixi’VN Character Emotions</DynamicLink> in ***ink***. To use the character emotions in ***ink***, you need to create a or more characters with an emotion in **Typescript** and, after that, in the ***ink* script**, you can use following syntax:

`character_id` + `@` + `emotion`

For example, you can associate this character with a dialogue using the following syntax:

`character_id` + `@` + `emotion` + `:` + `SPACE` + `text`

```ink tab="ink/start.ink"
=== start ===
liam@happy: Hi, I'm Liam. I'm very happy today.
-> DONE
```

```ts tab="values/characters.ts"
import { CharacterBaseModel, RegisteredCharacters } from "@drincs/pixi-vn";

export const liam = new CharacterBaseModel("liam", {
  name: "Liam",
});

export const liamHappy = new CharacterBaseModel(
  { id: "liam", emotion: "happy" },
  {
    name: "Liam Happy",
  }
);

RegisteredCharacters.add([liam, liamHappy]);
```

```ts tab="App.tsx"
import BackButton from "./components/BackButton";
import NextButton from "./components/NextButton";
import TextInput from "./screens/modals/TextInput";
import NarrationScreen from "./screens/NarrationScreen";

// Remember to import the character file at least once into your project. // [!code focus]
import "./values/characters"; // [!code focus]

export default function App() {
return (
    <>
        <NarrationScreen />
        <TextInput />
        <NextButton />
        <BackButton />
    </>
);
}
```

<Sandbox
  template="fdj2lt"
  entry="/src/ink/start.ink,/src/values/characters.ts"
/>
