---
ink: "/ink.svg"
title: "ink Language Integration"
---
import { InkExample } from "@/components/ink-examples";
import { Accordion, Accordions } from 'fumadocs-ui/components/accordion';

Pixi’VN gives you the ability to write your own narrative using ***ink***, a scripting language for writing interactive narrative.

The ***ink* + Pixi’VN integration**, exploits the [inkjs](https://github.com/inkle/inkjs) and <DynamicLink href="/other-topics/pixi-vn-json">PixiVNJson</DynamicLink> libraries, to parse ***ink* code** and generate a Json that can be interpreted by Pixi’VN. So Javascript/Typescript and ***ink*** share the same storage and canvas, and it is also possible to launch ***ink*** labels (or knots) from Javascript/Typescript and vice versa. This allows you to use the best of both languages. You can use ***ink*** to write the narration, while using Javascript/Typescript to create minigames or complex animations.

**What is *ink*?** ***ink*** is a scripting language for writing interactive narrative. It is used in games like 80 Days, Heaven's Vault, and Sorcery! to create branching stories. This language is very simple to learn. You can learn more about *ink* on the [*ink* website](https://www.inklestudios.com/ink/).

```ink title="ink/start.ink"
=== start ===
We arrived into London at 9.45pm exactly.

* "There is not a moment to lose!"[] I declared.
 -> hurry_outside

* "Monsieur, let us savour this moment!"[] I declared.
 My master clouted me firmly around the head and dragged me out of the door.
 -> dragged_outside

* [We hurried home] -> hurry_outside

=== hurry_outside ===
We hurried home to Savile Row -> as_fast_as_we_could

=== dragged_outside ===
He insisted that we hurried home to Savile Row
-> as_fast_as_we_could

=== as_fast_as_we_could ===
<> as fast as we could.
-> start
```

<InkExample />

## Why?

Write a narrative in **Javascript/Typescript** slows you down a lot, because you have to write a lot of code, and is also not suitable for novice developers. So ***ink*** is a good alternative to write the narrative, because it is very simple to learn and write.

The novice developers can use a <DynamicLink href="/start#project-initialization">*ink* template</DynamicLink> to start developing just with ***ink***, and then gradually learn Javascript/Typescript to create more complex features.

## Installation

<Callout title="Templates" type="info">

If you are starting a new Pixi'VN project, it is recommended to use one of the <DynamicLink href="/start#project-initialization">templates</DynamicLink> that already include *ink*.

</Callout>

To install the *ink* package in an existing JavaScript project, use one of the following commands:

```sh tab="npm"
npm install @drincs/pixi-vn @drincs/pixi-vn-ink
```

```sh tab="yarn"
yarn add @drincs/pixi-vn @drincs/pixi-vn-ink
```

```sh tab="pnpm"
pnpm add @drincs/pixi-vn @drincs/pixi-vn-ink
```

```sh tab="bun"
bun add @drincs/pixi-vn @drincs/pixi-vn-ink
```

```sh tab="deno"
deno install npm:@drincs/pixi-vn npm:@drincs/pixi-vn-ink
```

### Initialize

After installing the package you need to use the `importInkText()` function to import the ***ink* script** into your project.

```typescript title="main.ts"
import { importInkText } from '@drincs/pixi-vn-ink'

const inkText = `
=== start ===
Hello
-> END
`

importInkText([inkText, ...])
```

Now you can run the ***ink* knot** (or label) with <DynamicLink href="/start/labels#run-a-label">Pixi’VN functions</DynamicLink>.

```typescript title="main.ts"
import { narration } from '@drincs/pixi-vn'

narration.callLabel(`start`, {})
```

<Accordions>

<Accordion title="Import text contained in .ink files" id="import-ink-files">

For this guide we will use the [Vite](https://vitejs.dev/) project, but you can use the same logic in other projects.

To import text contained in `.ink` files you need create the file `ink.d.ts` to declare the module `*.ink`.

After that you need to add the `.ink` extension to the `assetsInclude` option in the `vite.config.ts` file.

After that you can import the *ink* file and add `?raw` at the end of the import to get the text content.

```ts tab="main.ts"
import { importInkText } from '@drincs/pixi-vn-ink'
import startLabel from './ink/start.ink?raw'

importInkText([startLabel, ...])
```

```ts tab="vite.config.ts"
export default defineConfig({
  // ...
  assetsInclude: ['**/*.ink'],
})
```

```ts tab="ink.d.ts"
declare module '*.ink' {
    const value: string
    export default value
}
```

</Accordion>

<Accordion title="Import .ink files from a folder" id="import-ink-folder">

If you have many `.ink` files in a folder, you can use `import.meta.glob` to import all the files in the folder.

```ts tab="utils/ink-utility.ts"
import { convertInkText, importInkText } from "@drincs/pixi-vn-ink";

async function getInkText() {
    const files = import.meta.glob<string>("../ink/*.{ink,txt}", { query: "?raw", import: "default" });
    return await Promise.all(
        Object.values(files).map(async (importFile) => {
            return await importFile();
        })
    );
}

export async function importAllInkLabels() {
    let fileEntries = await getInkText();
    await importInkText(fileEntries);
}

export async function convertInkToJson() {
    let fileEntries = await getInkText();
    return await Promise.all(fileEntries.map((data) => convertInkText(data)));
}
```

```ts tab="vite.config.ts"
export default defineConfig({
  // ...
  assetsInclude: ['**/*.ink'],
})
```

</Accordion>

<Accordion title="Vite.js plugin" id="vite-plugin">

To improve the developer experience you can use the vite plugins.

```ts tab="vite.config.ts"
import { defineConfig } from 'vite'
import { noHmrInkPlugin } from '@drincs/pixi-vn-ink/vite'
export default defineConfig({
  // ...
  plugins: [
    noHmrInkPlugin()
  ]
})
```

```ts tab="main.ts"
import { setupInkHmrListener } from '@drincs/pixi-vn-ink'

setupInkHmrListener()
```

</Accordion>

</Accordions>

## *ink* features in development

The following features are in development and will be added in the future:

( Add a like or comment to the issue to show your interest )

* [Functions and Game Queries](https://github.com/inkle/ink/blob/master/Documentation/WritingWithInk#9-game-queries-and-functions) (issue [#11](https://github.com/DRincs-Productions/pixi-vn-ink/issues/11)):
  * [User-created functions](https://github.com/inkle/ink/blob/master/Documentation/WritingWithInk#5-functions) (issue [#32](https://github.com/DRincs-Productions/pixi-vn-ink/issues/32))
  * `CHOICE_COUNT()`
  * `TURNS()`
  * `TURNS_SINCE()`
  * `SEED_RANDOM()`
* [`LIST`](https://github.com/inkle/ink/blob/master/Documentation/WritingWithInk#1-basic-lists) (issue [#15](https://github.com/DRincs-Productions/pixi-vn-ink/issues/15))
* [`Tunnels`](https://github.com/inkle/ink/blob/master/Documentation/WritingWithInk#1-tunnels) (issue [#38](https://github.com/DRincs-Productions/pixi-vn-ink/issues/38))
* [`Threads`](https://github.com/inkle/ink/blob/master/Documentation/WritingWithInk#2-threads) (issue [#39](https://github.com/DRincs-Productions/pixi-vn-ink/issues/39))

## *ink* syntax that will be ignored by Pixi’VN

The following syntax will be ignored by Pixi’VN. You can use them in your ***ink* script** ( For example if you want test your script with **Inky editor** ), but they will be ignored by Pixi’VN.

### INCLUDE

`INCLUDE` is used by ***ink*** to import other ***ink* files**.

In Pixi’VN you can use the `importInkText()` function to import the ***ink* files**. So if you use `INCLUDE` it will not be handled, so it does not import the files.

### Narration outside the knots

The narration outside the knots (or labels) will be ignored, except for variables. So for example:

```ink title="ink"
VAR my_var = false // ✅ This will be handled (because it is a variable)
Hello // ❌ This will be ignored [!code warning]
-> start // ❌ This will be ignored [!code warning]
=== start === // ✅ This will be handled
My name is John // ✅ This will be handled
-> DONE // ✅ This will be handled
```

## Differences between native *ink* and Pixi’VN *ink*

* in this case:

    ```ink title="ink"
    { shuffle:
      -  2 of Diamonds.
        'You lose this time!' crowed the croupier.
    }
    ```

    **In native *ink***, you will see 2 different dialogues, the first one will be `2 of Diamonds.` and the second one will be `'You lose this time!' crowed the croupier.`.

    **In Pixi’VN *ink***, you will not see 2 different dialogues, but the following dialogue: `2 of Diamonds.\n\n'You lose this time!' crowed the croupier.`. In <DynamicLink href="/ink/ink-markup#markdown-on-ink">Markdown</DynamicLink> it will be displayed as:

    ```txt
    2 of Diamonds.
    'You lose this time!' crowed the croupier.
    ```

* if a `weave` (In following example `shove`) is attached to a one time choice, and it is opened with `-> shove` it will not invalidate the one time choice. To invalidate it you will have to select the choice as usual.

    Here is an example:

    ```ink title="ink"
    -> start
    === start ===
    * [1] -> shove
    * (shove) [2] 2
    * {shove} [3] -> END
    -  -> start
    -> DONE
    ```

    In case you take choice 1, the second time it will be opened `start`:
  * if you use **native *ink***, you will only be able to choose choice `3`. The choice `2` is hidden because being "one time" **native *ink*** will know that you have already made this decision with `-> shove`.
  * if you use **Pixi’VN *ink***, you will be able to choose choice `2` or `3`. The choice `2` is not hidden because **Pixi’VN *ink*** doesn't know that `shove` is paired with a choice.

  To get the same logic as `start` both in **native *ink*** and **Pixi’VN *ink*** you will have to write the following code:

  ```ink title="ink"
  -> start
  === start ===
  * [1] -> shove
  * (shove) {!shove} [2] 2
  * {shove} [3] -> END
  -  -> start
  -> DONE
  ```
