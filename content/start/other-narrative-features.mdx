---
title: Other narrative features
description: Covers additional narrative features in Pixi'VN, including end-of-game handling, error management, and random number generation.
---

## Managing the end of the game

When all `steps` of all `labels` are executed, the game will stop. The developer is responsible for handling the end of the game, as visual novels can have different ending strategies:

* The game ends when all `steps` are executed.
* The game has no end; if the `steps` are finished, it is considered an error and should be handled.
* The game ends when the player reaches a specific point, such as a game over screen.

To manage the end of the game, set `Game.onEnd`. This function is called when the game ends and has the same signature as a `step`.

For example, to end the game and navigate to an end screen:

```ts title="main.ts"
import { Game } from '@drincs/pixi-vn'

Game.onEnd(async (props) => {
    props.navigate("/end")
})
```

If your game has no end and should restart or loop:

```ts title="labels/startLabel.ts"
export const startLabel = newLabel("start_label_id",
    () => {
        return [
            // ...
        ]
    }
)
```

```ts title="main.ts"
import { Game } from '@drincs/pixi-vn'

Game.onEnd(async (props) => {
    narration.callLabel(startLabel, props)
})
```

## Handling step errors

If an error occurs in a `step`, the game logs an error to the console and stops executing further steps. The developer should handle errors by setting `Game.onError`.

For example, to send a notification when an error occurs:

```ts title="main.ts"
import { Game } from '@drincs/pixi-vn'

Game.onError((type, error, { notify }) => {
    notify("An error occurred")
    // Optionally send the error to GlitchTip, Sentry, etc.
})
```

## Random number generation

Pixiâ€™VN includes a built-in function to generate random numbers. Use `narration.getRandomNumber()` with the following parameters:

* `min`: The minimum value.
* `max`: The maximum value.
* `options` (Optional):
  * `onceonly`: If `true`, the number will be generated only once for the current `step` of the `label` (default: `false`). Note: `min` and `max` affect the storage of already generated numbers.
