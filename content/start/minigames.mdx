---
title: Minigames
---

<Callout type="warn">

In the process of writing

</Callout>

```tsx tab="React"
import { PIXI } from "@drincs/pixi-vn";
import { useCallback, useMemo, useRef } from "react";
import useMinigame from "../hooks/useMinigame";

const { Graphics, Ticker } = PIXI;

export default function MiniGame() {
    const ticker = useMemo(() => new Ticker(), []);
    const onKeyDown = useCallback((e: KeyboardEvent) => {
        // Handle key down events for game controls
    }, []);
    const gameScoreRef = useRef({ x: 1, y: 0 });

    const { loading } = useMinigame(
        (layer) => {
            window.addEventListener("keydown", onKeyDown);

            ticker.add(({ deltaMS }) => {
                // Update game logic here
            });
            ticker.start();
        },
        {
            onExit() {
                ticker.stop();
                ticker.destroy();
                window.removeEventListener("keydown", onKeyDown);
            },
        }
    );

    return (
        <div
            style={{
                position: "absolute",
                bottom: 0,
                right: 0,
                textAlign: "center",
                pointerEvents: "auto",
            }}
        >
            <div style={{ marginTop: "10px" }}>
                <button style={{ fontSize: "30px" }} onClick={() => setDirection(0, -1)}>
                    ⬆️
                </button>
            </div>
            <div>
                <button style={{ fontSize: "30px", marginRight: "50px" }} onClick={() => setDirection(-1, 0)}>
                    ⬅️
                </button>
                <button style={{ fontSize: "30px" }} onClick={() => setDirection(1, 0)}>
                    ➡️
                </button>
            </div>
            <div>
                <button style={{ fontSize: "30px" }} onClick={() => setDirection(0, 1)}>
                    ⬇️
                </button>
            </div>
        </div>
    );
}
```

```ts tab="hooks/useMinigame.ts"
import { canvas, Layer, PIXI } from "@drincs/pixi-vn";
import { useEffect, useRef } from "react";
import { CANVAS_MINIGAME_LAYER_NAME } from "../constans";

export default function useMinigame(
    game: (layer: Layer) => void,
    props?: {
        onStart?: () => Promise<void>;
        onExit?: (layer: Layer) => void;
    }
) {
    const { onStart = () => Promise.resolve(), onExit } = props || {};
    const loading = useRef(false);

    useEffect(() => {
        loading.current = true;
        const layer = canvas.addLayer(CANVAS_MINIGAME_LAYER_NAME, new PIXI.Container());
        if (!layer) {
            console.error("Failed to create UI layer for minigame");
            return;
        }
        onStart().then(() => {
            loading.current = false;
            game(layer);
        });

        return () => {
            canvas.removeLayer(CANVAS_MINIGAME_LAYER_NAME);
            if (onExit) {
                onExit(layer);
            }
        };
    }, [game, onStart, onExit]);

    return {
        loading,
    };
}
```
