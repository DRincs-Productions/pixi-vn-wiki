---
title: Как перевести визуальную новеллу?
---

В визуальных новеллах и других типах игр обычно есть возможность выбрать язык игры.

В проекте Pixi’VN вам необходимо использовать внешние библиотеки для работы с переводами. Поэтому вы можете выбрать ту реализацию, которая вам больше подходит.

Наиболее используемой библиотекой, совместимой со многими фреймворками, является i18next.

![i18next-h2](/i18next.svg)

## i18next

**What is i18next?** i18next is an internationalization-framework written in and for JavaScript. Для того чтобы использовать i18n, необходимо установить и инициализировать его. You can learn more about i18next on the [i18next website](https://www.i18next.com/).

The translations will be inserted into multiple json files (one json file for each language) with the key value correspondence. Where the key is a unique key of the text (or the text to be translated) and the value is the text that will be displayed. It is recommended to split the translations into two parts (see `strings_es.json` file):

- The <DynamicLink href="/start/interface">UI</DynamicLink> texts, that is, the texts that are contained in screens, settings, quick buttons, etc... that is, everything that is not part of the narration.
- The <DynamicLink href="/start/narration">narration</DynamicLink> texts, i.e. the texts contained in the dialogues, in the choice menu, etc...

```ts tab="i18n.ts"
import i18n from 'i18next';
import LanguageDetector from 'i18next-browser-languagedetector';
import { initReactI18next } from 'react-i18next';
import strings_en from '../src/values/translations/strings_en.json';
import strings_es from '../src/values/translations/strings_es.json';

const getUserLang = (): string => {
    let userLang: string = navigator.language || "en";
    return userLang?.toLocaleLowerCase()?.split("-")[0];
}

export const useI18n = () => {
    if (!i18n.isInitialized) {
        i18n
            .use(LanguageDetector)
            .use(initReactI18next)
            .init({
                debug: false,
                fallbackLng: 'en',
                lng: getUserLang(),
                interpolation: {
                    escapeValue: false,
                },
                resources: {
                    en: strings_en,
                    es: strings_es,
                    // Add more languages here
                }
            });
    }
}
```

```ts tab="main.ts"
import { useI18n } from './i18n';

useI18n()
```

## Переведите пользовательский интерфейс

Чтобы перевести UI, необходимо использовать функцию `t`, предоставляемую i18next. Функция `t` - это функция, которая будет вызываться при передаче клавиши в качестве входного сигнала для получения соответствующего текста на языке игрока.

For example:

```tsx tab="React"
import { useTranslation } from 'react-i18next';

export default function MyComponent() {
    const { t } = useTranslation("ui");

    return (
        <div>
            <Button>{t("text_speed")}</Button>
        </div>
    );
}
```

```vue tab="Vue"
<script setup>
    import { useTranslation } from "i18next-vue";
    const { t } = useTranslation("ui");
</script>

<template>
    <div>
        <button>{{ t('text_speed') }}</button>
    </div>
</template>
```

```svelte tab="Svelte"
<script>
    import { useTranslation } from 'svelte-i18n';
    const { t } = useTranslation("ui");
</script>

<div>
    <button>{t('text_speed')}</button>
</div>
```

## Перевод повествования (TypeScript/JavaScript)

Чтобы перевести UI, вам нужно "переопределить" интерфейс `StepLabelProps` в файле `.d.ts`, чтобы добавить функцию `t`. Функция `t` - это функция, которая будет вызываться при передаче клавиши в качестве входного сигнала для получения соответствующего текста на языке игрока.

This way you can use the `t` function in <DynamicLink href="/start/labels">labels</DynamicLink> to translate the text. It is recommended to use `t` inside the <DynamicLink href="/start/labels">label</DynamicLink> and not when the UI is displayed, because this way you can use the [i18n Interpolation](https://i18next.com/translation-function/interpolation).

В качестве ключа перевода рекомендуется использовать родную строку, с которой выполняется перевод.

```ts tab="labels/startLabel.ts"
export const startLabel = newLabel("start_label",
    [
        ({ t }) => { // [!code focus]
            narration.dialogue = {
                character: liam,
                text: t("Hello, my name is {{name}}", { name: "Liam" }) // [!code focus]
            }
        },
    ]
)
```

```ts tab="pixi-vn.d.ts"
declare module '@drincs/pixi-vn' {
    interface StepLabelProps {
        /**
         * Translate a key to a string.
         * @param key The key to translate.
         * @returns The translated string.
         */
        t: TFunction<[string], undefined>
        // ...
    }
}
```

## Create the json file to translate

```json tab="locales/strings_es.json"
{
    "ui": {
        "text_speed": "Velocidad del texto",
        // ...
    },
    "narration": {
        "Hello, my name is {{name}}": "Hola, mi nombre es {{name}}"
        // ...
    }
}
```
