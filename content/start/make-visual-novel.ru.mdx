---
title: Создайте свою первую визуальную новеллу
description: Пошаговое руководство по созданию визуальной новеллы с помощью Pixi’VN, охватывающее настройку проекта, повествование, ассеты и интерактивность.
---

import { TSVisualNovelExample } from "@/components/vn-examples";

Это руководство проведет вас через процесс создания вашей первой визуальной новеллы.

**Что такое визуальная новелла?** Визуальная новелла (ВН) - это форма цифровой интерактивной фантастики. Визуальные новеллы часто ассоциируются с серединой видеоигр, но не всегда сами по себе являются таковыми. Они сочетают в себе текстовое повествование со статичными или анимированными иллюстрациями и различной степенью интерактивности. Реже этот формат называют игрой-новеллой, что является ретрансляцией термина noberu gēmu (ノベルゲーム), который чаще используется в японском языке.

В целях тестирования в этом руководстве мы будем воссоздавать визуальную новеллу [Breakdown](https://joshpowlison.itch.io/breakdown) с помощью Pixi’VN. Breakdown - это короткая история, в которой есть всё, что должно быть в визуальной новелле. Джош Поулисон, создатель Breakdown, дал разрешение на использование его дикторского текста для образовательных целей❤️.

Поскольку Pixi'VN даёт вам возможность написать собственное повествование, выбрав один или несколько <DynamicLink href="/start/narration">доступных языков повествования</DynamicLink>, на каждом этапе разработки будут создаваться примеры для каждого из доступных на данный момент языков.

## Создать новый проект

Первый шаг - создание нового проекта. You can find more information on how to create a new project starting from a template <DynamicLink href="/start#project-initialization">here</DynamicLink>. Мы будем использовать шаблон "Визуальная новелла - React".

`Visual Novel -> React`

После завершения создания очень важно прочитать файл `README.md`, который находится в корне проекта. Этот файл содержит важную информацию о проекте и о том, как его использовать.

В нашем случае для запуска проекта достаточно выполнить следующие команды:

```bash
npm install
npm start
```

## Создание персонажей

Теперь мы определим персонажей этой истории. Для этого в файле `/values/characters.ts` мы определим персонажей, которых будем использовать. Больше информации о том, как создавать и использовать персонажей, вы можете найти на странице: <DynamicLink href="/start/character">Персонажи</DynamicLink>

Что означает `mc`? `mc` - распространенное сокращение от "Main Character". В визуальных романах принято использовать `mc` (Main Character) в качестве имени главного героя.

```ts tab="values/characters.ts"
import { RegisteredCharacters } from "@drincs/pixi-vn";
import Character from "../models/Character";

export const mc = new Character('mc', {
    name: 'Me',
});

export const james = new Character('james', {
    name: 'James',
    color: "#0084ac"
});

export const steph = new Character('steph', {
    name: 'Steph',
    color: "#ac5900"
});

export const sly = new Character('sly', {
    name: 'Sly',
    color: "#6d00ac"
});

RegisteredCharacters.add([mc, james, steph, sly]);
```

```ts tab="App.tsx"
// Remember to import the character file at least once into your project. // [!code focus]
import "./values/characters"; // [!code focus]

export default function App() {
return // ...
}
```

## Первый набросок повествования

<Callout title="Markup" type="info">

Все шаблоны поддерживают <DynamicLink href="/start/markup-markdown">Markdown</DynamicLink> и <DynamicLink href="/start/markup-tailwindcss">Tailwind CSS</DynamicLink>, поэтому мы будем использовать это для нашего повествования.

</Callout>

Теперь мы можем приступить к написанию "первого черновика" <DynamicLink href="/start/narration">повествования</DynamicLink> визуальной новеллы.
Мы создадим первую <DynamicLink href="/start/labels">`label`</DynamicLink> под названием `start`, который будет началом игры. После этого мы можем написать <DynamicLink href="/start/dialogue">диалоги</DynamicLink>, которые последуют в нашей визуальной новелле.

Вот пример:

```ink tab="ink" title="ink/start.ink" groupId="narrative_language"
=== start ===
james: You're my roommate's replacement, huh?
james: Don't worry, you don't have much to live up to. Just don't use heroin like the last guy, and you' fine!
mc: ...

He thrusts out his hand.

james: James!
mc: ...Peter.

I take his hand and shake.

james: Ooh, Peter! Nice, firm handshake! The last quy always gave me the dead fish. I already think we'r gonna get along fine.
james: Come on in and... 
james: ...
james: I know you're both watching, come on out already!

sly: I just wanted to see what the new guy was like. Hey, you, Peter- be nice to our little brother, or you'll have to deal with *us*.
mc: ...
james: Peter, this is Sly. Yes, that is her real name.

I put out my hand.

sly: I'm not shakin' your hand until I decide you're an all-right dude. Sorry, policy.
mc: Fair enough, I'm a pretty scary guy, or so l've been told.
james: The redhead behind her is Stephanie.
// Example of using Tailwind CSS
steph: <span class="inline-block motion-translate-y-loop-25">Hey</span>! Everyone calls me Steph. I'll shake your hand.

// ...
-> DONE
```

```ts tab="Typescript" title="labels/startLabel.ts" groupId="narrative_language"
const startLabel = newLabel("start", [
    () => narration.dialogue = { character: james, text: `You're my roommate's replacement, huh?` },
    () => narration.dialogue = { character: james, text: `Don't worry, you don't have much to live up to. Just don't use heroin like the last guy, and you' fine!` },
    () => narration.dialogue = { character: mc, text: `...` },
    () => { narration.dialogue = "He thrusts out his hand." },
    () => narration.dialogue = { character: james, text: `James!` },
    () => narration.dialogue = { character: mc, text: `...Peter.` },
    () => { narration.dialogue = "I take his hand and shake." },
    () => narration.dialogue = { character: james, text: `Ooh, Peter! Nice, firm handshake! The last quy always gave me the dead fish. I already think we'r gonna get along fine.` },
    () => narration.dialogue = { character: james, text: `Come on in and...` },
    () => narration.dialogue = { character: james, text: `...` },
    () => narration.dialogue = { character: james, text: `I know you're both watching, come on out already!` },
    () => narration.dialogue = { character: james, text: `I just wanted to see what the new guy was like. Hey, you, Peter- be nice to our little brother, or you'll have to deal with *us*.` },
    () => narration.dialogue = { character: mc, text: `...` },
    () => narration.dialogue = { character: james, text: `Peter, this is Sly. Yes, that is her real name.` },
    () => { narration.dialogue = "I put out my hand." },
    () => narration.dialogue = { character: james, text: `I'm not shakin' your hand until I decide you're an all-right dude. Sorry, policy.` },
    () => narration.dialogue = { character: mc, text: `Fair enough, I'm a pretty scary guy, or so l've been told.` },
    () => narration.dialogue = { character: james, text: `The redhead behind her is Stephanie.` },
    // Example of using Tailwind CSS
    () => narration.dialogue = { character: steph, text: `<span class="inline-block motion-translate-y-loop-25">Hey</span>! Everyone calls me Steph. I'll shake your hand.` },
    // ...
]);
export default startLabel;
```

### Split the narrative into labels

Не рекомендуется создавать очень длинные `labels` (даже для линейных визуальных новелл), но рекомендуется создавать несколько небольших `labels` и «вызывать» их по мере необходимости с помощью <DynamicLink href="/start/labels-flow">функций управления потоком повествования</DynamicLink>.

По этой причине, даже если наша история линейна, она будет разделена на два `labels`, первый из которых мы только что создали, а второй будет называться `second_part`.

Вот пример:

```ink tab="ink" title="ink/start.ink" groupId="narrative_language"
=== start ===
james: You're my roommate's replacement, huh?
james: Don't worry, you don't have much to live up to. Just don't use heroin like the last guy, and you' fine!
mc: ...

He thrusts out his hand.

james: James!
mc: ...Peter.

// ...
-> second_part

=== second_part ===

She enters my room before I'VE even had a chance to. \\n\\n...I could've just come back and gotten the platter later...
She sets it on a desk. I throw my two paper bags down beside the empty bed.

steph: They got you a new mattress, right? That last guy was a druggie, did James tell you that?
sly: *We're* the reason he got expelled!
steph: Sly! If word gets out about that... well, actually, it wouldn't matter, *he's* the one who shot himself up.

I'm fumbling for a new subject.

// ...
-> DONE
```

```ts tab="Typescript" title="labels/startLabel.ts" groupId="narrative_language"
const startLabel = newLabel("start", [
    () => narration.dialogue = { character: james, text: `You're my roommate's replacement, huh?` },
    () => narration.dialogue = { character: james, text: `Don't worry, you don't have much to live up to. Just don't use heroin like the last guy, and you' fine!` },
    () => narration.dialogue = { character: mc, text: `...` },
    () => { narration.dialogue = "He thrusts out his hand." },
    () => narration.dialogue = { character: james, text: `James!` },
    () => narration.dialogue = { character: mc, text: `...Peter.` },
    // ...
    async (props) => await narration.jump(secondPart, props),
]);
export default startLabel;

const secondPart = newLabel("second_part", [
    () => { narration.dialogue = `She enters my room before I'VE even had a chance to. \n\n...I could've just come back and gotten the platter later...` },
    () => { narration.dialogue = `She sets it on a desk. I throw my two paper bags down beside the empty bed.` },
    () => narration.dialogue = { character: steph, text: `They got you a new mattress, right? That last guy was a druggie, did James tell you that?` },
    () => narration.dialogue = { character: sly, text: `*We're* the reason he got expelled!` },
    () => narration.dialogue = { character: steph, text: `Sly! If word gets out about that... well, actually, it wouldn't matter, *he's* the one who shot himself up.` },
    () => { narration.dialogue = `I'm fumbling for a new subject.` },
    // ...
]);
```

## Меню выбора

Теперь мы спросим игрока, хочет ли он продолжить знакомство со второй частью визуальной новеллы.

Для этого мы воспользуемся <DynamicLink href="/start/choices">меню выбора</DynamicLink>.

Вот пример:

```ink tab="ink" title="ink/start.ink" groupId="narrative_language"
=== start ===
// ...

You want continue to the next part?
* Yes, I want to continue
-> second_part
* No, I want to stop here
-> END

=== second_part ===

// ...
-> DONE
```

```ts tab="Typescript" title="labels/startLabel.ts" groupId="narrative_language"
const startLabel = newLabel("start", [
    // ...
    async () => {
        narration.dialogue = `You want continue to the next part?`
        narration.choices = [
            newChoiceOption("Yes, I want to continue", secondPart, {}, { type: "jump" }),
            newCloseChoiceOption("No, I want to stop here"),
        ]
    },
]);
export default startLabel;

const secondPart = newLabel("second_part", [
    // ...
]);
```

## Редактирование информации о персонажах и использование её в качестве переменной

Теперь я дам игроку возможность изменить имя `mc`.

Для этого я попрошу игрока <DynamicLink href="/start/input">заполнить поле ввода, используя функции Pixi’VN</DynamicLink>.

После получения значения ввода вы можете <DynamicLink href="/start/character#edit">установить имя персонажа</DynamicLink> с использованием полученного значения.

Вот пример:

```ink tab="ink" title="ink/start.ink" groupId="narrative_language"
=== start ===
// ...

He thrusts out his hand.
# request input type string default Peter
What is your name?
# rename mc { _input_value_ }

// ...
-> DONE
```

```ts tab="Typescript" title="labels/startLabel.ts" groupId="narrative_language"
const startLabel = newLabel("start", [
    // ...
    () => { narration.dialogue = `He thrusts out his hand.` },
    () => {
        narration.requestInput({ type: "string" }, "Peter")
        narration.dialogue = `What is your name?`
    },
    () => {
        mc.name = narration.inputValue as string
    },
    // ...
]);
export default startLabel;
```

Теперь мы можем <DynamicLink href="/start/character#use">использовать имена персонажей</DynamicLink> в диалогах.

Вот пример:

```ink tab="ink" title="ink/start.ink" groupId="narrative_language"
VAR steph_fullname = "Stephanie"

=== start ===
// ...

sly: I just wanted to see what the new guy was like. Hey, you, [mc]- be nice to our little brother, or you'll have to deal with *us*.
mc: ...
james: [mc], this is [sly]. Yes, that is her real name.

I put out my hand.

sly: I'm not shakin' your hand until I decide you're an all-right dude. Sorry, policy.
mc: Fair enough, I'm a pretty scary guy, or so l've been told.
james: The redhead behind her is [steph_fullname].
steph: Hey! Everyone calls me [steph]. I'll shake your hand.

She puts out her hand, and I take it.

mc: Thanks, good to meet you, [steph_fullname].
steph: WOW, that is, like, the most perfect handshake I've ever had! Firm, but also gentle. [sly], you *gotta* shake his hand!

// ...
-> DONE
```

```ts tab="Typescript" title="labels/startLabel.ts" groupId="narrative_language"
const steph_fullname = "Stephanie";

const startLabel = newLabel("start", [
    // ...
    () => narration.dialogue = { character: sly, text: `I just wanted to see what the new guy was like. Hey, you, ${mc.name}- be nice to our little brother, or you'll have to deal with *us*.` },
    () => narration.dialogue = { character: mc, text: `...` },
    () => narration.dialogue = { character: james, text: `${mc.name}, this is ${sly.name}. Yes, that is her real name.` },
    () => { narration.dialogue = `I put out my hand.` },
    () => narration.dialogue = { character: sly, text: `I'm not shakin' your hand until I decide you're an all-right dude. Sorry, policy.` },
    () => narration.dialogue = { character: mc, text: `Fair enough, I'm a pretty scary guy, or so I've been told.` },
    () => narration.dialogue = { character: james, text: `The redhead behind her is ${steph_fullname}.` },
    () => narration.dialogue = { character: steph, text: `Hey! Everyone calls me ${steph.name}. I'll shake your hand.` },
    () => { narration.dialogue = `She puts out her hand, and I take it.` },
    () => narration.dialogue = { character: mc, text: `Thanks, good to meet you, ${steph_fullname}.` },
    () => narration.dialogue = { character: steph, text: `WOW, that is, like, the most perfect handshake I've ever had! Firm, but also gentle. ${sly.name}, you *gotta* shake his hand!` },
    // ...
]);
export default startLabel;
```

## Использование функции "клея" в диалогах

В визуальных новеллах часто бывает полезно вставить текст в текущий диалог. Например, чтобы приостановить разговор и продолжить его в следующем `step`. Для этого мы можем воспользоваться <DynamicLink href="/start/dialogue#dialogue-glue">функцией клея</DynamicLink>.

Вот пример:

```ink tab="ink" title="ink/start.ink" groupId="narrative_language"
=== start ===
// ...

james: Ooh, [mc]! Nice, firm handshake!
<>The last guy always gave me the dead fish.
<>I already think we're gonna get along fine.
james: Come on in and...

// ...
-> DONE
```

```ts tab="Typescript" title="labels/startLabel.ts" groupId="narrative_language"
const startLabel = newLabel("start", [
    // ...
    async () => narration.dialogue = { character: james, text: `Ooh, ${mc.name}! Nice, firm handshake!` },
    async () => {
        narration.dialogGlue = true
        narration.dialogue = `The last guy always gave me the dead fish.`
    },
    async () => {
        narration.dialogGlue = true
        narration.dialogue = `I already think we're gonna get along fine.`
    },
    async () => narration.dialogue = { character: james, text: `Come on in and...` },
    // ...
]);
export default startLabel;
```

## Определите текстуры и загрузите их

<Callout type="info">

Загрузка и работа с ресурсами (изображениями, gif-файлами, видео...) вам необходимо использовать `Assets`. `Assets` - это класс с множеством функций, который поставляется из библиотеки PixiJS, если вы хотите получить больше информации, читайте [здесь](https://pixijs.com/8.x/guides/components/assets).

</Callout>

One of the first steps is choosing where to save your visual novel assets. В данном случае мы сохраним текстуры в хранилище Firebase (хостинговый сервис). Вы можете использовать любой хостинг-сервис по вашему выбору или даже сохранить ассеты локально в проекте, более подробную информацию вы можете найти <DynamicLink href="/start/assets">здесь</DynamicLink>.

Перед использованием текстур настоятельно рекомендуется <DynamicLink href="/start/assets-management#initialize-the-asset-matrix-at-project-start">инициализировать матрицу текстур</DynamicLink>.

По умолчанию, как вы можете видеть в файле `assets/manifest.ts`, все шаблоны в `onLoadingLabel` пытаются загрузить в фоновом режиме "bundle assets" с псевдонимом, равным текущему id `label`. Поэтому рекомендуется добавить в `manifest` "bundle assets" для каждого `label` с псевдонимом, равным id `label`, и содержащим изображения, используемые в этом `label`.

Вот пример:

```ts tab="assets/manifest.ts"
import { AssetsManifest } from "@drincs/pixi-vn";
import { MAIN_MENU_ROUTE } from "../constans";

/**
 * Manifest for the assets used in the game.
 * You can read more about the manifest here: https://pixijs.com/8.x/guides/components/assets#loading-multiple-assets
 */
const manifest: AssetsManifest = {
    bundles: [
        // screens
        {
            name: MAIN_MENU_ROUTE,
            assets: [
                {
                    alias: "background_main_menu",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fmain-menu.webp?alt=media",
                },
            ],
        },
        // labels
        {
            name: "start",
            assets: [
                {
                    alias: "bg01-hallway",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fbg01-hallway.webp?alt=media",
                },
            ],
        },
        {
            name: "second_part",
            assets: [
                {
                    alias: "bg02-dorm",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fbg02-dorm.webp?alt=media",
                },
            ],
        },
        // characters
        {
            name: "fm01",
            assets: [
                {
                    alias: "fm01-body",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-body.webp?alt=media",
                },
                {
                    alias: "fm01-eyes-grin",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-eyes-grin.webp?alt=media",
                },
                {
                    alias: "fm01-eyes-smile",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-eyes-smile.webp?alt=media",
                },
                {
                    alias: "fm01-eyes-soft",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-eyes-soft.webp?alt=media",
                },
                {
                    alias: "fm01-eyes-upset",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-eyes-upset.webp?alt=media",
                },
                {
                    alias: "fm01-eyes-wow",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-eyes-wow.webp?alt=media",
                },
                {
                    alias: "fm01-mouth-grin00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-mouth-grin00.webp?alt=media",
                },
                {
                    alias: "fm01-mouth-serious00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-mouth-serious00.webp?alt=media",
                },
                {
                    alias: "fm01-mouth-serious01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-mouth-serious01.webp?alt=media",
                },
                {
                    alias: "fm01-mouth-smile00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-mouth-smile00.webp?alt=media",
                },
                {
                    alias: "fm01-mouth-smile01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-mouth-smile01.webp?alt=media",
                },
                {
                    alias: "fm01-mouth-soft00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-mouth-soft00.webp?alt=media",
                },
                {
                    alias: "fm01-mouth-soft01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-mouth-soft01.webp?alt=media",
                },
                {
                    alias: "fm01-mouth-upset00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-mouth-upset00.webp?alt=media",
                },
                {
                    alias: "fm01-mouth-upset01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-mouth-upset01.webp?alt=media",
                },
                {
                    alias: "fm01-mouth-wow01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm01%2Ffm01-mouth-wow01.webp?alt=media",
                },
            ],
        },
        {
            name: "fm02",
            assets: [
                {
                    alias: "fm02-body",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-body.webp?alt=media",
                },
                {
                    alias: "fm02-eyes-bawl",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-eyes-bawl.webp?alt=media",
                },
                {
                    alias: "fm02-eyes-joy",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-eyes-joy.webp?alt=media",
                },
                {
                    alias: "fm02-eyes-nervous",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-eyes-nervous.webp?alt=media",
                },
                {
                    alias: "fm02-eyes-smile",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-eyes-smile.webp?alt=media",
                },
                {
                    alias: "fm02-eyes-upset",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-eyes-upset.webp?alt=media",
                },
                {
                    alias: "fm02-eyes-wow",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-eyes-wow.webp?alt=media",
                },
                {
                    alias: "fm02-mouth-cry01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-mouth-cry01.webp?alt=media",
                },
                {
                    alias: "fm02-mouth-nervous00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-mouth-nervous00.webp?alt=media",
                },
                {
                    alias: "fm02-mouth-nervous01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-mouth-nervous01.webp?alt=media",
                },
                {
                    alias: "fm02-mouth-smile00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-mouth-smile00.webp?alt=media",
                },
                {
                    alias: "fm02-mouth-smile01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-mouth-smile01.webp?alt=media",
                },
                {
                    alias: "fm02-mouth-upset00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-mouth-upset00.webp?alt=media",
                },
                {
                    alias: "fm02-mouth-upset01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-mouth-upset01.webp?alt=media",
                },
                {
                    alias: "fm02-mouth-wow01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Ffm02%2Ffm02-mouth-wow01.webp?alt=media",
                },
            ],
        },
        {
            name: "m01",
            assets: [
                {
                    alias: "m01-body",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-body.webp?alt=media",
                },
                {
                    alias: "m01-eyes-annoy",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-eyes-annoy.webp?alt=media",
                },
                {
                    alias: "m01-eyes-concern",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-eyes-concern.webp?alt=media",
                },
                {
                    alias: "m01-eyes-cry",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-eyes-cry.webp?alt=media",
                },
                {
                    alias: "m01-eyes-grin",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-eyes-grin.webp?alt=media",
                },
                {
                    alias: "m01-eyes-smile",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-eyes-smile.webp?alt=media",
                },
                {
                    alias: "m01-eyes-wow",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-eyes-wow.webp?alt=media",
                },
                {
                    alias: "m01-mouth-annoy00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-mouth-annoy00.webp?alt=media",
                },
                {
                    alias: "m01-mouth-annoy01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-mouth-annoy01.webp?alt=media",
                },
                {
                    alias: "m01-mouth-concern00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-mouth-concern00.webp?alt=media",
                },
                {
                    alias: "m01-mouth-concern01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-mouth-concern01.webp?alt=media",
                },
                {
                    alias: "m01-mouth-cry00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-mouth-cry00.webp?alt=media",
                },
                {
                    alias: "m01-mouth-cry01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-mouth-cry01.webp?alt=media",
                },
                {
                    alias: "m01-mouth-grin00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-mouth-grin00.webp?alt=media",
                },
                {
                    alias: "m01-mouth-neutral00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-mouth-neutral00.webp?alt=media",
                },
                {
                    alias: "m01-mouth-neutral01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-mouth-neutral01.webp?alt=media",
                },
                {
                    alias: "m01-mouth-smile00",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-mouth-smile00.webp?alt=media",
                },
                {
                    alias: "m01-mouth-smile01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-mouth-smile01.webp?alt=media",
                },
                {
                    alias: "m01-mouth-wow01",
                    src: "https://firebasestorage.googleapis.com/v0/b/pixi-vn.appspot.com/o/public%2Fbreakdown%2Fm01%2Fm01-mouth-wow01.webp?alt=media",
                },
            ],
        },
    ],
};
export default manifest;
```

```ts tab="utils/defineAssets.ts"
import { Assets } from "@drincs/pixi-vn";
import manifest from "../assets/manifest";

/**
 * Define all the assets that will be used in the game.
 * This function will be called before the game starts.
 * You can read more about assets management in the documentation: https://pixi-vn.web.app/start/assets-management.html
 */
export async function defineAssets() {
    Assets.init({ manifest });

    // The game will not start until these asserts are loaded.
    await Assets.loadBundle("main_menu");

    // The game will start immediately, but these asserts will be loaded in the background.
    // Assets.backgroundLoadBundle("main_menu");
    // Assets.backgroundLoad("background_main_menu");
}
```

```ts tab="src/main.ts"
import { Assets, canvas, Container, Game } from "@drincs/pixi-vn";
import { createRoot } from "react-dom/client";
import App from "./App";
import { CANVAS_UI_LAYER_NAME } from "./constans";
import "./index.css";
import "./values/characters";

// ...

Game.onLoadingLabel((_stepId, { id }) => { // [!code focus]
    Assets.backgroundLoadBundle(id); // [!code focus]
}); // [!code focus]
```

## Добавить фон и изображения персонажей

Теперь пришло время подумать о визуальной части тоже. Мы добавим спрайты фона и персонажей на холст визуальной новеллы.

**Что такое спрайт? ** В компьютерной графике спрайт - это двухмерное растровое изображение, которое интегрируется в большую сцену, чаще всего в двухмерной видеоигре.

В нашем случае спрайты персонажей состоят из 3 изображений: тела, глаз и рта. Затем мы используем <DynamicLink href="/start/canvas-image-container">ImageContainer</DynamicLink> для создания персонажа. Вы можете найти больше информации о том, как добавить компоненты canvas, в <DynamicLink href="/start/canvas-components">этом руководстве</DynamicLink>.

Вот пример:

```ink tab="ink" title="ink/start.ink" groupId="narrative_language"
=== start ===
# show image bg bg01-hallway
# show imagecontainer james [m01-body m01-eyes-smile m01-mouth-neutral01] xAlign 0.5 yAlign 1
james: You're my roommate's replacement, huh?
# show imagecontainer james [m01-body m01-eyes-grin m01-mouth-smile01]
james: Don't worry, you don't have much to live up to. Just don't use heroin like the last guy, and you'll be fine!
# show imagecontainer james [m01-body m01-eyes-smile m01-mouth-grin00]
mc: ...

// ...
-> DONE
```

```ts tab="Typescript" title="labels/startLabel.ts" groupId="narrative_language"
const startLabel = newLabel("start", [
    async () => {
        await showImage("bg", "bg01-hallway");
        await showImageContainer("james", ["m01-body", "m01-eyes-smile", "m01-mouth-neutral01"], { xAlign: 0.5, yAlign: 1 });
        narration.dialogue = { character: james, text: `You're my roommate's replacement, huh?` }
    },
    async () => {
        await showImageContainer("james", ["m01-body", "m01-eyes-grin", "m01-mouth-smile01"])
        narration.dialogue = { character: james, text: `Don't worry, you don't have much to live up to. Just don't use heroin like the last guy, and you'll be fine!` }
    },
    async () => {
        await showImageContainer("james", ["m01-body", "m01-eyes-smile", "m01-mouth-grin00"])
        narration.dialogue = { character: mc, text: `...` }
    },
    // ...
]);
export default startLabel;
```

## Умная загрузка текстур

В нашем случае мы сохранили игровые изображения на хостинге (Firebase). По этой причине загрузка текстур происходит несвоевременно.

Чтобы игрок не получал слишком много загрузок, мы должны сгруппировать их в определенные фазы игры. В моем случае я загружу самые часто используемые изображения в начале `label`.

Вы можете найти дополнительную информацию о том, как управлять загрузками, <DynamicLink href="/start/assets-management">здесь</DynamicLink>.

Вот пример:

```ink tab="ink" title="ink/start.ink" groupId="narrative_language"
=== start ===
# lazyload bundle m01 fm01 fm02 // [!code focus]

# show image bg bg01-hallway
# show imagecontainer james [m01-body m01-eyes-smile m01-mouth-neutral01] xAlign 0.5 yAlign 1 with movein direction right speed 300
james: You're my roommate's replacement, huh?
# show imagecontainer james [m01-body m01-eyes-grin m01-mouth-smile01]
james: Don't worry, you don't have much to live up to. Just don't use heroin like the last guy, and you'll be fine!
# show imagecontainer james [m01-body m01-eyes-smile m01-mouth-grin00]
mc: ...

// ...
-> DONE
```

```ts tab="Typescript" title="labels/startLabel.ts" groupId="narrative_language"
const startLabel = newLabel("start", [
    // ...
], {
    onLoadingLabel: () => { // [!code focus]
        Assets.backgroundLoadBundle(["fm01", "fm02", "m01"]); // [!code focus]
    } // [!code focus]
});
export default startLabel;
```

## Использовать переходы

Чтобы сделать визуальную новеллу более динамичной, можно использовать переходы для показа изображений. Вы можете найти дополнительную информацию о том, как использовать переходы, <DynamicLink href="/start/canvas-transition">здесь</DynamicLink>.

Вот пример:

```ink tab="ink" title="ink/start.ink" groupId="narrative_language"
=== start ===
// ...

# show image bg bg01-hallway
# show imagecontainer james [m01-body m01-eyes-smile m01-mouth-neutral01] xAlign 0.5 yAlign 1 with movein direction right speed 300
james: You're my roommate's replacement, huh?
# show imagecontainer james [m01-body m01-eyes-grin m01-mouth-smile01]
james: Don't worry, you don't have much to live up to. Just don't use heroin like the last guy, and you'll be fine!
# show imagecontainer james [m01-body m01-eyes-smile m01-mouth-grin00]
mc: ...

// ...
-> DONE
```

```ts tab="Typescript" title="labels/startLabel.ts" groupId="narrative_language"
const startLabel = newLabel("start", [
    async () => {
        await showImage("bg", "bg01-hallway");
        await moveIn(
            "james",
            {
                value: ["m01-body", "m01-eyes-smile", "m01-mouth-neutral01"],
                options: { xAlign: 0.5, yAlign: 1 },
            },
            { direction: "right", ease: "circInOut", type: "spring" }
        );
        narration.dialogue = { character: james, text: `You're my roommate's replacement, huh?` };
    },
    async () => {
        await showImageContainer("james", ["m01-body", "m01-eyes-grin", "m01-mouth-smile01"]);
        narration.dialogue = {
            character: james,
            text: `Don't worry, you don't have much to live up to. Just don't use heroin like the last guy, and you'll be fine!`,
        };
    },
    async () => {
        await showImageContainer("james", ["m01-body", "m01-eyes-smile", "m01-mouth-grin00"]);
        narration.dialogue = { character: mc, text: `...` };
    },
    // ...
]);
export default startLabel;
```

## Создание анимации

Чтобы сделать визуальную новеллу более динамичной, можно использовать анимацию. Для получения дополнительной информации о том, как использовать анимации, см. <DynamicLink href="/start/canvas-animations-effects">здесь</DynamicLink>.

Я рекомендую использовать TypeScript, если вам нужно установить много свойств, так как это дает вам больше контроля, функциональности и обратной связи по типам.

В этом примере моя анимация удалит `steph` из сцены и вставит ее обратно на следующем `step`. Я также отзеркалю её по оси x, чтобы убедиться, что она направлена в нужную сторону.

Чтобы убрать `steph` из сцены/вставить ее обратно, я буду использовать функции `moveOut` и `moveIn`. Для зеркального эффекта я буду использовать функцию `canvas.animate`.

Сначала я использую функцию `canvas.animate`, чтобы создать анимацию, которая устанавливает свойство `scaleX` от `-1` (зеркальное) до `1`, с `autoplay: false`, чтобы она не начинала воспроизводиться сразу.

Затем я использую функцию `moveIn`, чтобы вернуть `steph` в сцену, передавая `tickerId` анимации, чтобы ее можно было возобновить после завершения перехода.

Я использую опцию `forceCompleteBeforeNext: true`, чтобы гарантировать, что анимация завершится перед тем, как будет выполнен следующий `step`. Для `moveIn`, будучи переходом, `forceCompleteBeforeNext` по умолчанию равно true.

Поскольку я использую TypeScript для этой анимации, я создал `label` для нее, чтобы ее можно было вызывать и из других языков.

```ts title="labels/animation01.ts"
import { canvas, ImageContainer, moveIn, newLabel } from "@drincs/pixi-vn";

export const animation01 = newLabel("animation_01", [
    async () => {
        let tickerId = canvas.animate<ImageContainer>(
            "steph",
            {
                scaleX: 1,
            },
            { autoplay: false, forceCompleteBeforeNext: true }
        );

        await moveIn(
            "steph",
            {
                value: ["fm02-body", "fm02-eyes-joy", "fm02-mouth-smile01"],
                options: { xAlign: 0.8, yAlign: 1, scale: { y: 1, x: -1 }, anchor: 0.5 },
            },
            { direction: "right", ease: "easeInOut", tickerIdToResume: tickerId }
        );
    },
]);
```

<Callout type="info" title="ink">

As explained <DynamicLink href="/ink/labels#use-the-call-script">here</DynamicLink>, from _ink_ you can call `labels` written in JS/TS and vice versa.

</Callout>

Теперь вы можете вызывать этот `label` (`animation_01`) из основного `label` (`start`).

```ink tab="ink" title="ink/start.ink" groupId="narrative_language"
=== start ===
// ...

# show imagecontainer james [m01-body m01-eyes-grin m01-mouth-grin00]
# show imagecontainer sly [fm01-body fm01-eyes-smile fm01-mouth-smile00]
# show imagecontainer steph [fm02-body fm02-eyes-upset fm02-mouth-nervous00]
# remove image steph with moveout direction left speed 300
[steph_fullname] goes through the opposite door,
# call animation_01
<> and returns with a HUGE tinfoil-covered platter.

// ...
-> DONE
```

```ts tab="Typescript" title="labels/startLabel.ts" groupId="narrative_language"
const startLabel = newLabel("start", [
    // ...
    async () => {
        await showImageContainer("james", ["m01-body", "m01-eyes-grin", "m01-mouth-grin00"]);
        await showImageContainer("sly", ["fm01-body", "fm01-eyes-smile", "fm01-mouth-smile00"]);
        await showImageContainer("steph", ["fm02-body", "fm02-eyes-upset", "fm02-mouth-nervous00"]);
        moveOut("steph", { direction: "left", speed: 300 });
        narration.dialogue = `${steph_fullname} goes through the opposite door,`;
    },
    async (props) => {
        narration.dialogGlue = true;
        narration.dialogue = ` and returns with a HUGE tinfoil-covered platter.`;
        await narration.call(animation01, props);
    },
    // ...
]);
export default startLabel;
```

<Comments>
## Используйте анимацию и эффекты или создайте свой тикер

Страница в разработке.

:::tabs

== ink example

```ink title="ink"

```

== Typescript example

```ts

```

:::

## Добавить музыку и звуковые эффекты

Страница в разработке.

:::tabs

== ink example

```ink title="ink"

```

== Typescript example

```ts

```

::: -->

</Comments>

## Заключение

Теперь вы знаете, как создать визуальную новеллу с помощью Pixi'VN. С большой силой приходит большая ответственность, так что используйте её с умом и создайте прекрасную историю! 🚀

Вот интерактивный пример с минимальным UI (HTML). Прокрутя вниз, вы можете увидеть тот же результат, используя полный UI (шаблон React).

<Tabs items={["ink", "Typescript"]} groupId="narrative_language">
<Tab>
<Sandbox
  template="2r5f6v"
  entry="/src/ink/start.ink"
/>
</Tab>
<Tab>
<TSVisualNovelExample />
</Tab>
</Tabs>

<iframe src="https://pixi-vn-react-template.web.app/"
    title="Visual Novel - React"
    style={{
        width: "100%",
        height: "400px",
        border: "0",
        borderRadius: "4px",
        overflow: "hidden",
    }}
    allowFullScreen={true}
></iframe>
