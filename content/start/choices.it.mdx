---
title: Menù a scelta
description: Spiega come implementare e personalizzare i menu di scelta interattivi in Pixi'VN, consentendo ai giocatori di prendere decisioni che influenzano la storia.
---

import { ChoiceMenus } from "@/components/examples";
import { Accordion, Accordions } from 'fumadocs-ui/components/accordion';

<Callout title="UI screen" type="info">

Un esempio della schermata dell'interfaccia utente del menu di scelta è disponibile nella sezione <DynamicLink href="/start/interface-examples#choice-menu">esempi di interfaccia</DynamicLink>.

</Callout>

Nelle visual novel, i menu di scelta consentono al giocatore di prendere decisioni che influenzano la storia.

In Pixi'VN puoi chiedere al giocatore di fare una scelta. Ogni scelta può avviare una `label` o chiudere il menu delle scelte.

## Richiedi al giocatore di fare una scelta

Per richiedere al giocatore di effettuare una scelta, impostare `narration.choiceMenuOptions` con un array di `StoredChoiceInterface`. Per creare un oggetto `StoredChoiceInterface`, usa:

<Accordions>

<Accordion title="newChoiceOption" id="newchoiceoption">

In Pixi'VN, puoi creare un'opzione di menu di scelta utilizzando la funzione `newChoiceOption`.
Questa funzione ha i seguenti parametri:

- `text`: Il testo visualizzato nel menu di scelta.
- `label`: La <DynamicLink href="/start/labels#label">label</DynamicLink> da chiamare quando il giocatore seleziona l'opzione.
- `props`: The properties passed to the `label`. If the label does not require parameters, pass an empty object `{}`.
- `options` (Opzionale): Un oggetto con le opzioni di `choice`:
  - `type`: How the <DynamicLink href="/start/labels-flow#run-a-label">label will be performed</DynamicLink>. Può essere `call` o `jump`. Il valore predefinito è `call`.
  - `oneTime`: Se `true`, la scelta può essere effettuata solo una volta.
  - `onlyHaveNoChoice`: Se `true`, la scelta viene mostrata solo se non ci sono altre scelte.
  - `autoSelect`: Se è `true` ed è l'unica scelta, verrà selezionata automaticamente.

</Accordion>

<Accordion title="newCloseChoiceOption" id="newCloseChoiceOption">

Oltre a `newChoiceOption`, puoi usare `newCloseChoiceOption` per creare un'opzione di chiusura. Questo chiude il menu di scelta e continua con gli <DynamicLink href="/start/labels">step</DynamicLink>, senza richiamare alcuna <DynamicLink href="/start/labels#label">label</DynamicLink>.
Questa funzione ha i seguenti parametri:

- `text`: Il testo visualizzato nel menu di scelta.
- `options` (Opzionale): Un oggetto con le opzioni di `choice`:
  - `closeCurrentLabel`: Se `true`, la `label` corrente verrà chiusa. Il valore predefinito è `false`.
  - `oneTime`: Se `true`, la scelta può essere effettuata solo una volta.
  - `onlyHaveNoChoice`: Se `true`, la scelta viene mostrata solo se non ci sono altre scelte.
  - `autoSelect`: Se è `true` ed è l'unica scelta, verrà selezionata automaticamente.

</Accordion>

</Accordions>

```ts title="labels/startLabel.ts"
import { newChoiceOption, newCloseChoiceOption, narration, newLabel } from "@drincs/pixi-vn"

export const startLabel = newLabel("start_label",
    [
        async () => {
            narration.dialogue = "Choose a fruit:"
            narration.choiceMenuOptions = [ // [!code focus]
                newChoiceOption("Orange", orangeLabel, {}), // by default, the label will be called with "call" // [!code focus]
                newChoiceOption("Banana", bananaLabel, {}, { type: "jump" }), // [!code focus]
                newChoiceOption("Apple", appleLabel, { quantity: 5 }, { type: "call" }), // [!code focus]
                newCloseChoiceOption("Cancel"), // [!code focus]
            ] // [!code focus]
        },
        () => { narration.dialogue = "Restart" },
        async (props) => await narration.jumpLabel("start_label", props)
    ],
)
```

<ChoiceMenus />

## Ottieni

Per ottenere il menu di scelta corrente, usa `narration.choiceMenuOptions`. This returns an array of `StoredChoiceInterface`.

```typescript
const menuOptions: StoredChoiceInterface[] = narration.choiceMenuOptions;
```

## Richiesta

Per selezionare un'opzione, utilizzare `narration.selectChoice`.

```typescript
const item = narration.choiceMenuOptions![0]; // get the first item

narration.selectChoice(item, {
    // Add StepLabelProps here
    navigate: navigate, // example
    // And the props to pass to the label
    ...item.props
})
    .then(() => {
        // ...
    })
    .catch((e) => {
        // ...
    })
```

## Rimuovi

Per cancellare le opzioni di scelta, imposta `narration.choiceMenuOptions = undefined`.

```typescript
narration.choiceMenuOptions = undefined;
```

## Classe personalizzata

È possibile personalizzare un'opzione del menu di scelta aggiungendo proprietà all'interfaccia `ChoiceInterface`. Ad esempio, aggiungi una proprietà `icon` per visualizzare un'icona.

Sostituisci l'interfaccia `ChoiceInterface` nel tuo file `.d.ts`:

```ts tab="pixi-vn.d.ts"
declare module '@drincs/pixi-vn' {
    interface ChoiceInterface {
        icon?: string
    }
}
```

```ts tab="labels/startLabel.ts"
narration.choiceMenuOptions = [
    newChoiceOption("Orange", orangeLabel, {}, { icon: "orange.png" }),
    newChoiceOption("Banana", bananaLabel, {}, { icon: "banana.png" }),
    newChoiceOption("Apple", appleLabel, {}, { icon: "apple.png" }),
]
```

```tsx tab="screens/ChoiceMenu.tsx"
function ChoiceMenu({ choices }: { choices: StoredIndexedChoiceInterface[] }) {
    return (
        <div>
            {choices.map((choice, index) => (
                <div key={index}>
                    {choice.icon && <img src={choice.icon} alt={choice.text} />}
                    <button onClick={() => narration.selectChoice(choice)}>{choice.text}</button>
                </div>
            ))}
        </div>
    )
}
```
