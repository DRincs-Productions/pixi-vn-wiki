---
title: Menù a scelta
description: Spiega come implementare e personalizzare i menu di scelta interattivi in Pixi'VN, consentendo ai giocatori di prendere decisioni che influenzano la storia.
---

import { ChoiceMenus } from "@/components/examples";
import { Accordion, Accordions } from 'fumadocs-ui/components/accordion';

<Callout title="UI screen" type="info">

Un esempio della schermata dell'interfaccia utente del menu di scelta è disponibile nella sezione <DynamicLink href="/start/interface-examples#choice-menu">esempi di interfaccia</DynamicLink>.

</Callout>

Nelle visual novel, i menu di scelta consentono al giocatore di prendere decisioni che influenzano la storia.

In Pixi'VN puoi chiedere al giocatore di fare una scelta. Ogni scelta può avviare una `label` o chiudere il menu delle scelte.

## Richiedi al giocatore di fare una scelta

Per richiedere al giocatore di effettuare una scelta, impostare `narration.choiceMenuOptions` con un array di `StoredChoiceInterface`. Per creare un oggetto `StoredChoiceInterface`, usa:

<Accordions>

<Accordion title="newChoiceOption" id="newchoiceoption">

In Pixi'VN, puoi creare un'opzione di menu di scelta utilizzando la funzione `newChoiceOption`.
Questa funzione ha i seguenti parametri:

- `text`: Il testo visualizzato nel menu di scelta.
- `label`: La <DynamicLink href="/start/labels#label">label</DynamicLink> da chiamare quando il giocatore seleziona l'opzione.
- `props`: The properties passed to the `label`. If the label does not require parameters, pass an empty object `{}`.
- `options` (Opzionale): Un oggetto con le opzioni di `choice`:
  - `type`: How the <DynamicLink href="/start/labels-flow#run-a-label">label is called</DynamicLink>. Can be `call` or `jump`. Default is `call`.
  - `oneTime`: If `true`, the choice can only be made once.
  - `onlyHaveNoChoice`: If `true`, the choice is shown only if there are no other choices.
  - `autoSelect`: If `true` and it is the only choice, it will be selected automatically.

</Accordion>

<Accordion title="newChoiceOption" id="newchoiceoption">

In addition to `newChoiceOption`, you can use `newCloseChoiceOption` to create a closing option. This closes the choice menu and continues with the <DynamicLink href="/start/labels">steps</DynamicLink>, without calling any <DynamicLink href="/start/labels#label">label</DynamicLink>.
Questa funzione ha i seguenti parametri:

- `text`: Il testo visualizzato nel menu di scelta.
- `options` (Opzionale): Un oggetto con le opzioni di `choice`:
  - `closeCurrentLabel`: If `true`, the current `label` will be closed. Default is `false`.
  - `oneTime`: If `true`, the choice can only be made once.
  - `onlyHaveNoChoice`: If `true`, the choice is shown only if there are no other choices.
  - `autoSelect`: If `true` and it is the only choice, it will be selected automatically.

</Accordion>

</Accordions>

```ts title="labels/startLabel.ts"
import { newChoiceOption, newCloseChoiceOption, narration, newLabel } from "@drincs/pixi-vn"

export const startLabel = newLabel("start_label",
    [
        async () => {
            narration.dialogue = "Choose a fruit:"
            narration.choiceMenuOptions = [ // [!code focus]
                newChoiceOption("Orange", orangeLabel, {}), // by default, the label will be called with "call" // [!code focus]
                newChoiceOption("Banana", bananaLabel, {}, { type: "jump" }), // [!code focus]
                newChoiceOption("Apple", appleLabel, { quantity: 5 }, { type: "call" }), // [!code focus]
                newCloseChoiceOption("Cancel"), // [!code focus]
            ] // [!code focus]
        },
        () => { narration.dialogue = "Restart" },
        async (props) => await narration.jumpLabel("start_label", props)
    ],
)
```

<ChoiceMenus />

## Ottieni

To get the current choice menu, use `narration.choiceMenuOptions`. This returns an array of `newChoiceOption` and/or `newCloseChoiceOption`.

```typescript
const menuOptions: StoredChoiceInterface[] = narration.choiceMenuOptions;
```

## Request

To select a choice, use `narration.selectChoice`.

```typescript
const item = narration.choiceMenuOptions![0]; // get the first item

narration.selectChoice(item, {
    // Add StepLabelProps here
    navigate: navigate, // example
    // And the props to pass to the label
    ...item.props
})
    .then(() => {
        // ...
    })
    .catch((e) => {
        // ...
    })
```

## Rimuovi

To clear the choice options, set `narration.choiceMenuOptions = undefined`.

```typescript
narration.choiceMenuOptions = undefined;
```

## Classe personalizzata

You can customize a choice menu option by adding properties to the `ChoiceInterface` interface. For example, add an `icon` property to display an icon.

Override the `ChoiceInterface` interface in your `.d.ts` file:

```ts tab="pixi-vn.d.ts"
declare module '@drincs/pixi-vn' {
    interface ChoiceInterface {
        icon?: string
    }
}
```

```ts tab="labels/startLabel.ts"
narration.choiceMenuOptions = [
    newChoiceOption("Orange", orangeLabel, {}, { icon: "orange.png" }),
    newChoiceOption("Banana", bananaLabel, {}, { icon: "banana.png" }),
    newChoiceOption("Apple", appleLabel, {}, { icon: "apple.png" }),
]
```

```tsx tab="screens/ChoiceMenu.tsx"
function ChoiceMenu({ choices }: { choices: StoredIndexedChoiceInterface[] }) {
    return (
        <div>
            {choices.map((choice, index) => (
                <div key={index}>
                    {choice.icon && <img src={choice.icon} alt={choice.text} />}
                    <button onClick={() => narration.selectChoice(choice)}>{choice.text}</button>
                </div>
            ))}
        </div>
    )
}
```
